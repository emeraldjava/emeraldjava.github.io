---
title: JPA 1.0 Spring Context for an Embedded Derby DB
layout: post
category: blogger
# Pulled from Blogger. Last updated there on: Fri Sep 03 11:26:00 IST 2010
---
<pre class="brush: xml"><br /><br /><?xml version="1.0" encoding="UTF-8"?><br /><beans xmlns="http://www.springframework.org/schema/beans"<br />       xmlns:p="http://www.springframework.org/schema/p"<br />       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"<br />       xmlns:util="http://www.springframework.org/schema/util"<br />       xmlns:aop="http://www.springframework.org/schema/aop"<br />       xmlns:tx="http://www.springframework.org/schema/tx"<br />       xmlns:context="http://www.springframework.org/schema/context"<br />       xmlns:jee="http://www.springframework.org/schema/jee"<br />       xsi:schemaLocation="<br />       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd<br />       http://www.springframework.org/schema/util http://www.springframework.org/schema/beans/spring-util-2.5.xsd<br />       http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd<br />       http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd<br />       http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd<br />       http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-2.5.xsd"><br />          <br /> <bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource"><br />  <property name="driverClassName" value="org.apache.derby.jdbc.EmbeddedDriver"/><br />  <property name="url" value="jdbc:derby:/home/assure/derbydb/poc;create=true"/><br /> </bean><br /> <br /> <bean id="hibernateProperties" class="org.springframework.beans.factory.config.PropertiesFactoryBean"><br />  <property name="properties"><br />   <props><br />    <prop key="hibernate.hbm2ddl.auto">create</prop><br />    <prop key="hibernate.dialect">org.hibernate.dialect.DerbyDialect</prop><br />    <prop key="hibernate.query.substitutions">true 'T', false 'F'</prop><br />    <prop key="hibernate.show_sql">true</prop><br />    <prop key="hibernate.c3p0.minPoolSize">5</prop><br />    <prop key="hibernate.c3p0.maxPoolSize">20</prop><br />    <prop key="hibernate.c3p0.timeout">600</prop><br />    <prop key="hibernate.c3p0.max_statement">50</prop><br />    <prop key="hibernate.c3p0.testConnectionOnCheckout">false</prop><br />   </props><br />  </property><br /> </bean><br />  <br /><!-- <bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalEntityManagerFactoryBean">--><br /><!-- <property name="persistenceXmlLocation" value="classpath:persistence.xml" />--><br /><!--     <property name="persistenceUnitName" value="persistenceunit"/>--><br /><!--    </bean>--><br />    <br />    <bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean"><br /><br /><!--          <property name="persistenceXmlLocation" value="classpath:persistence.xml" />--><br />          <property name="persistenceUnitName"    value="persistenceunit" /><br />          <property name="dataSource"             ref="dataSource"/><br /><br />          <property name="jpaVendorAdapter"><br />               <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter"><br />                    <property name="database"         value="DERBY"/><br />                    <property name="showSql"          value="true"/><br />                    <property name="generateDdl"      value="true"/><br />                    <property name="databasePlatform" value="org.hibernate.dialect.DerbyDialect"/><br />               </bean><br />          </property><br /><br />          <property name="jpaPropertyMap"><br />               <map><br />                    <entry key="hibernate.transaction.flush_before_completion" value="true"/><br />                    <entry key="hibernate.transaction.auto_close_session"      value="true"/><br />                    <entry key="hibernate.current_session_context_class"       value="jta"/><br />                    <entry key="hibernate.connection.release_mode"             value="auto"/>                            <br />               </map><br />          </property><br /><br />          <property name="jpaDialect"><br />               <bean class="org.springframework.orm.jpa.vendor.HibernateJpaDialect"/><br />          </property><br /><br />    </bean><br />    <br />     <bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager"><br />       <property name="entityManagerFactory" ref="entityManagerFactory"/><br />       <property name="dataSource" ref="dataSource"/><br />    </bean> <br /><br />    <!-- entity objects --><br />    <bean id="cell" class="com.xx.xx.common.index.entity.CellEntity" scope="prototype"/><br />    <bean id="apn" class="com.xx.xx.common.index.entity.APNEntity" scope="prototype"/><br />        <br />    <!-- entity manager instances --><br />    <bean id="cellDao" class="com.xx.xx.common.index.GenericJPAEntityManager"><br />        <constructor-arg>            <value>com.xx.xx.common.index.entity.CellEntity</value><br />        </constructor-arg>        <property name="entityManagerFactory" ref="entityManagerFactory"/>  <br /><br />    </bean><br /><br />    <bean id="apnDao" class="com.xx.xx.common.index.GenericJPAEntityManager"><br /><br />        <constructor-arg>            <value>com.xx.xx.common.index.entity.APNEntity</value><br />        </constructor-arg>        <property name="entityManagerFactory" ref="entityManagerFactory"/>  <br /><br />    </bean><br /><br />     <br /><br />    <br /><br />    <!-- http://robertmaldon.blogspot.com/2007/05/creating-spring-bean-from-java-5-enum.html --><br /><br /><br /><br /> <bean id="CELL" class="com.xx.xx.common.index.IndexType"<br />  factory-method="valueOf"><br /><br />  <constructor-arg>   <value>CELL</value><br />  </constructor-arg> </bean><br /><br /><br /><br /> <bean id="APN" class="com.xx.xx.common.index.IndexType"<br />  factory-method="valueOf"><br /><br />  <constructor-arg>   <value>APN</value><br />  </constructor-arg> </bean><br /><br /><br /><br /> <bean id="genericEntityFactory"<br />  class="com.xx.xx.common.index.GenericEntityFactoryImpl"><br /><br /><br /><br />  <property name="indexEntityMap"><br /><br />   <map><br /><br />    <entry key-ref="CELL" value-ref="cell" /><br /><br />    <entry key-ref="APN" value-ref="apn" /><br /><br />   </map><br /><br />  </property><br /><br />  <property name="entityManagerMap"><br /><br />   <map><br /><br />    <entry key-ref="CELL" value-ref="cellDao" /><br /><br />    <entry key-ref="APN" value-ref="apnDao" /><br /><br />   </map><br /><br />  </property><br /><br /><br /><br /> </bean>     <br /><br /><br /><br /></beans><br /><br /></pre><br />the associated persistence.xml<br /><br /><pre class="brush: xml"><persistence xmlns="http://java.sun.com/xml/ns/persistence" version="1.0"> <br />    <persistence-unit name="persistenceunit" transaction-type="RESOURCE_LOCAL"/><br /></persistence><br /></pre>
